{срезы минутные}
/*ReportName="Отчёт КА-4 VG1. Экран 2" (срезы минутные)*/
/*Mode=минутные*/
/*UpQuery="срезы на конец часа"*/

SET QUOTED_IDENTIFIER OFF
SELECT
	DateTime as "Дата",
	null,
	CAST(K4_VG1_P49b as decimal(15, 1)) as "П49б<br>°С [K4_VG1_P49b]",
	CAST(K4_VG1_P50b as decimal(15, 1)) as "П50б<br>°С [K4_VG1_P50b]",
	CAST(K4_VG1_P51b as decimal(15, 1)) as "П51б<br>°С [K4_VG1_P51b]",
	CAST(K4_VG1_P52b as decimal(15, 1)) as "П52б<br>°С [K4_VG1_P52b]",
	CAST(K4_VG1_P53b as decimal(15, 1)) as "П53б<br>°С [K4_VG1_P53b]",
	CAST(K4_VG1_P54b as decimal(15, 1)) as "П54б<br>°С [K4_VG1_P54b]",
	CAST(K4_VG1_P55b as decimal(15, 1)) as "П55б<br>°С [K4_VG1_P55b]",
	CAST(K4_VG1_P56b as decimal(15, 1)) as "П56б<br>°С [K4_VG1_P56b]",
	CAST(K4_VG1_P57b as decimal(15, 1)) as "П57б<br>°С [K4_VG1_P57b]",
	CAST(K4_VG1_P58b as decimal(15, 1)) as "П58б<br>°С [K4_VG1_P58b]",
	CAST(K4_VG1_P59b as decimal(15, 1)) as "П59б<br>°С [K4_VG1_P59b]",
	CAST(K4_VG1_P60b as decimal(15, 1)) as "П60б<br>°С [K4_VG1_P60b]",
	CAST(K4_VG1_P61b as decimal(15, 1)) as "П61б<br>°С [K4_VG1_P61b]",
	CAST(K4_VG1_P62b as decimal(15, 1)) as "П62б<br>°С [K4_VG1_P62b]",
	CAST(K4_VG1_P63b as decimal(15, 1)) as "П63б<br>°С [K4_VG1_P63b]",
	CAST(K4_VG1_P64b as decimal(15, 1)) as "П64б<br>°С [K4_VG1_P64b]",
	CAST(K4_VG1_P65b as decimal(15, 1)) as "П65б<br>°С [K4_VG1_P65b]",
	CAST(K4_VG1_P66b as decimal(15, 1)) as "П66б<br>°С [K4_VG1_P66b]",
	CAST(K4_VG1_P67b as decimal(15, 1)) as "П67б<br>°С [K4_VG1_P67b]",
	CAST(K4_VG1_P68b as decimal(15, 1)) as "П68б<br>°С [K4_VG1_P68b]",
	CAST(K4_VG1_P69b as decimal(15, 1)) as "П69б<br>°С [K4_VG1_P69b]",
	CAST(K4_VG1_P70b as decimal(15, 1)) as "П70б<br>°С [K4_VG1_P70b]",
	CAST(K4_VG1_P71b as decimal(15, 1)) as "П71б<br>°С [K4_VG1_P71b]",
	CAST(K4_VG1_P72b as decimal(15, 1)) as "П72б<br>°С [K4_VG1_P72b]",
	CAST(K4_VG1_P73b as decimal(15, 1)) as "П73б<br>°С [K4_VG1_P73b]",
	CAST(K4_VG1_P74b as decimal(15, 1)) as "П74б<br>°С [K4_VG1_P74b]",
	CAST(K4_VG1_P75b as decimal(15, 1)) as "П75б<br>°С [K4_VG1_P75b]",
	CAST(K4_VG1_P76b as decimal(15, 1)) as "П76б<br>°С [K4_VG1_P76b]",
	CAST(K4_VG1_P77b as decimal(15, 1)) as "П77б<br>°С [K4_VG1_P77b]",
	CAST(K4_VG1_P78b as decimal(15, 1)) as "П78б<br>°С [K4_VG1_P78b]",
	CAST(K4_VG1_P79b as decimal(15, 1)) as "П79б<br>°С [K4_VG1_P79b]",
	CAST(K4_VG1_P80b as decimal(15, 1)) as "П80б<br>°С [K4_VG1_P80b]",
	CAST(K4_VG1_P81b as decimal(15, 1)) as "П81б<br>°С [K4_VG1_P81b]",
	CAST(K4_VG1_P82b as decimal(15, 1)) as "П82б<br>°С [K4_VG1_P82b]",
	CAST(K4_VG1_P83b as decimal(15, 1)) as "П83б<br>°С [K4_VG1_P83b]",
	CAST(K4_VG1_P84b as decimal(15, 1)) as "П84б<br>°С [K4_VG1_P84b]",
	CAST(K4_VG1_P85b as decimal(15, 1)) as "П85б<br>°С [K4_VG1_P85b]",
	CAST(K4_VG1_P86b as decimal(15, 1)) as "П86б<br>°С [K4_VG1_P86b]",
	CAST(K4_VG1_P87b as decimal(15, 1)) as "П87б<br>°С [K4_VG1_P87b]",
	CAST(K4_VG1_P88b as decimal(15, 1)) as "П88б<br>°С [K4_VG1_P88b]",
	CAST(K4_VG1_P89b as decimal(15, 1)) as "П89б<br>°С [K4_VG1_P89b]",
	CAST(K4_VG1_P90b as decimal(15, 1)) as "П90б<br>°С [K4_VG1_P90b]",
	CAST(K4_VG1_P91b as decimal(15, 1)) as "П91б<br>°С [K4_VG1_P91b]",
	CAST(K4_VG1_P92b as decimal(15, 1)) as "П92б<br>°С [K4_VG1_P92b]",
	CAST(K4_VG1_P93b as decimal(15, 1)) as "П93б<br>°С [K4_VG1_P93b]",
	CAST(K4_VG1_P94b as decimal(15, 1)) as "П94б<br>°С [K4_VG1_P94b]",
	CAST(K4_VG1_P95b as decimal(15, 1)) as "П95б<br>°С [K4_VG1_P95b]"
FROM
	OpenQuery(INSQL,
	"SELECT DateTime,
	K4_VG1_P49b,
	K4_VG1_P50b,
	K4_VG1_P51b,
	K4_VG1_P52b,
	K4_VG1_P53b,
	K4_VG1_P54b,
	K4_VG1_P55b,
	K4_VG1_P56b,
	K4_VG1_P57b,
	K4_VG1_P58b,
	K4_VG1_P59b,
	K4_VG1_P60b,
	K4_VG1_P61b,
	K4_VG1_P62b,
	K4_VG1_P63b,
	K4_VG1_P64b,
	K4_VG1_P65b,
	K4_VG1_P66b,
	K4_VG1_P67b,
	K4_VG1_P68b,
	K4_VG1_P69b,
	K4_VG1_P70b,
	K4_VG1_P71b,
	K4_VG1_P72b,
	K4_VG1_P73b,
	K4_VG1_P74b,
	K4_VG1_P75b,
	K4_VG1_P76b,
	K4_VG1_P77b,
	K4_VG1_P78b,
	K4_VG1_P79b,
	K4_VG1_P80b,
	K4_VG1_P81b,
	K4_VG1_P82b,
	K4_VG1_P83b,
	K4_VG1_P84b,
	K4_VG1_P85b,
	K4_VG1_P86b,
	K4_VG1_P87b,
	K4_VG1_P88b,
	K4_VG1_P89b,
	K4_VG1_P90b,
	K4_VG1_P91b,
	K4_VG1_P92b,
	K4_VG1_P93b,
	K4_VG1_P94b,
	K4_VG1_P95b
	FROM Runtime.dbo.AnalogWideHistory 
	WHERE wwVersion = 'Latest'
	AND wwRetrievalMode = 'Cyclic'
	AND wwResolution = @resolution
	AND DateTime >= @start
	AND DateTime <= @finish")


{срезы на конец часа}
/*ReportName="Отчёт КА-4 VG1. Экран 2" (срезы на конец часа)*/
/*Mode=часовые-1*/
/*DownQuery="срезы минутные"*/
/*UpQuery="срезы на конец суток"*/

SET QUOTED_IDENTIFIER OFF
SELECT
	DateAdd(mi, -5, DateTime) as "Дата",
	null,
	CAST(K4_VG1_P49b as decimal(15, 1)) as "П49б<br>°С [K4_VG1_P49b]",
	CAST(K4_VG1_P50b as decimal(15, 1)) as "П50б<br>°С [K4_VG1_P50b]",
	CAST(K4_VG1_P51b as decimal(15, 1)) as "П51б<br>°С [K4_VG1_P51b]",
	CAST(K4_VG1_P52b as decimal(15, 1)) as "П52б<br>°С [K4_VG1_P52b]",
	CAST(K4_VG1_P53b as decimal(15, 1)) as "П53б<br>°С [K4_VG1_P53b]",
	CAST(K4_VG1_P54b as decimal(15, 1)) as "П54б<br>°С [K4_VG1_P54b]",
	CAST(K4_VG1_P55b as decimal(15, 1)) as "П55б<br>°С [K4_VG1_P55b]",
	CAST(K4_VG1_P56b as decimal(15, 1)) as "П56б<br>°С [K4_VG1_P56b]",
	CAST(K4_VG1_P57b as decimal(15, 1)) as "П57б<br>°С [K4_VG1_P57b]",
	CAST(K4_VG1_P58b as decimal(15, 1)) as "П58б<br>°С [K4_VG1_P58b]",
	CAST(K4_VG1_P59b as decimal(15, 1)) as "П59б<br>°С [K4_VG1_P59b]",
	CAST(K4_VG1_P60b as decimal(15, 1)) as "П60б<br>°С [K4_VG1_P60b]",
	CAST(K4_VG1_P61b as decimal(15, 1)) as "П61б<br>°С [K4_VG1_P61b]",
	CAST(K4_VG1_P62b as decimal(15, 1)) as "П62б<br>°С [K4_VG1_P62b]",
	CAST(K4_VG1_P63b as decimal(15, 1)) as "П63б<br>°С [K4_VG1_P63b]",
	CAST(K4_VG1_P64b as decimal(15, 1)) as "П64б<br>°С [K4_VG1_P64b]",
	CAST(K4_VG1_P65b as decimal(15, 1)) as "П65б<br>°С [K4_VG1_P65b]",
	CAST(K4_VG1_P66b as decimal(15, 1)) as "П66б<br>°С [K4_VG1_P66b]",
	CAST(K4_VG1_P67b as decimal(15, 1)) as "П67б<br>°С [K4_VG1_P67b]",
	CAST(K4_VG1_P68b as decimal(15, 1)) as "П68б<br>°С [K4_VG1_P68b]",
	CAST(K4_VG1_P69b as decimal(15, 1)) as "П69б<br>°С [K4_VG1_P69b]",
	CAST(K4_VG1_P70b as decimal(15, 1)) as "П70б<br>°С [K4_VG1_P70b]",
	CAST(K4_VG1_P71b as decimal(15, 1)) as "П71б<br>°С [K4_VG1_P71b]",
	CAST(K4_VG1_P72b as decimal(15, 1)) as "П72б<br>°С [K4_VG1_P72b]",
	CAST(K4_VG1_P73b as decimal(15, 1)) as "П73б<br>°С [K4_VG1_P73b]",
	CAST(K4_VG1_P74b as decimal(15, 1)) as "П74б<br>°С [K4_VG1_P74b]",
	CAST(K4_VG1_P75b as decimal(15, 1)) as "П75б<br>°С [K4_VG1_P75b]",
	CAST(K4_VG1_P76b as decimal(15, 1)) as "П76б<br>°С [K4_VG1_P76b]",
	CAST(K4_VG1_P77b as decimal(15, 1)) as "П77б<br>°С [K4_VG1_P77b]",
	CAST(K4_VG1_P78b as decimal(15, 1)) as "П78б<br>°С [K4_VG1_P78b]",
	CAST(K4_VG1_P79b as decimal(15, 1)) as "П79б<br>°С [K4_VG1_P79b]",
	CAST(K4_VG1_P80b as decimal(15, 1)) as "П80б<br>°С [K4_VG1_P80b]",
	CAST(K4_VG1_P81b as decimal(15, 1)) as "П81б<br>°С [K4_VG1_P81b]",
	CAST(K4_VG1_P82b as decimal(15, 1)) as "П82б<br>°С [K4_VG1_P82b]",
	CAST(K4_VG1_P83b as decimal(15, 1)) as "П83б<br>°С [K4_VG1_P83b]",
	CAST(K4_VG1_P84b as decimal(15, 1)) as "П84б<br>°С [K4_VG1_P84b]",
	CAST(K4_VG1_P85b as decimal(15, 1)) as "П85б<br>°С [K4_VG1_P85b]",
	CAST(K4_VG1_P86b as decimal(15, 1)) as "П86б<br>°С [K4_VG1_P86b]",
	CAST(K4_VG1_P87b as decimal(15, 1)) as "П87б<br>°С [K4_VG1_P87b]",
	CAST(K4_VG1_P88b as decimal(15, 1)) as "П88б<br>°С [K4_VG1_P88b]",
	CAST(K4_VG1_P89b as decimal(15, 1)) as "П89б<br>°С [K4_VG1_P89b]",
	CAST(K4_VG1_P90b as decimal(15, 1)) as "П90б<br>°С [K4_VG1_P90b]",
	CAST(K4_VG1_P91b as decimal(15, 1)) as "П91б<br>°С [K4_VG1_P91b]",
	CAST(K4_VG1_P92b as decimal(15, 1)) as "П92б<br>°С [K4_VG1_P92b]",
	CAST(K4_VG1_P93b as decimal(15, 1)) as "П93б<br>°С [K4_VG1_P93b]",
	CAST(K4_VG1_P94b as decimal(15, 1)) as "П94б<br>°С [K4_VG1_P94b]",
	CAST(K4_VG1_P95b as decimal(15, 1)) as "П95б<br>°С [K4_VG1_P95b]"
FROM
	OpenQuery(INSQL,
	"SELECT DateTime,
	K4_VG1_P49b,
	K4_VG1_P50b,
	K4_VG1_P51b,
	K4_VG1_P52b,
	K4_VG1_P53b,
	K4_VG1_P54b,
	K4_VG1_P55b,
	K4_VG1_P56b,
	K4_VG1_P57b,
	K4_VG1_P58b,
	K4_VG1_P59b,
	K4_VG1_P60b,
	K4_VG1_P61b,
	K4_VG1_P62b,
	K4_VG1_P63b,
	K4_VG1_P64b,
	K4_VG1_P65b,
	K4_VG1_P66b,
	K4_VG1_P67b,
	K4_VG1_P68b,
	K4_VG1_P69b,
	K4_VG1_P70b,
	K4_VG1_P71b,
	K4_VG1_P72b,
	K4_VG1_P73b,
	K4_VG1_P74b,
	K4_VG1_P75b,
	K4_VG1_P76b,
	K4_VG1_P77b,
	K4_VG1_P78b,
	K4_VG1_P79b,
	K4_VG1_P80b,
	K4_VG1_P81b,
	K4_VG1_P82b,
	K4_VG1_P83b,
	K4_VG1_P84b,
	K4_VG1_P85b,
	K4_VG1_P86b,
	K4_VG1_P87b,
	K4_VG1_P88b,
	K4_VG1_P89b,
	K4_VG1_P90b,
	K4_VG1_P91b,
	K4_VG1_P92b,
	K4_VG1_P93b,
	K4_VG1_P94b,
	K4_VG1_P95b
	FROM Runtime.dbo.AnalogWideHistory 
	WHERE wwVersion = 'Latest'
	AND wwRetrievalMode = 'Cyclic'
	AND wwResolution = @resolution
	AND DateTime >= @start
	AND DateTime <= @finish")


{срезы на конец суток}
/*ReportName="Отчёт КА-4 VG1. Экран 2" (срезы на конец суток)*/
/*Mode=суточные-1*/
/*DownQuery="срезы на конец часа"*/
/*UpQuery="агрегированные почасовые"*/

SET QUOTED_IDENTIFIER OFF
SELECT
	DateAdd(mi, -1445, DateTime) as "Дата",
	null,
	CAST(K4_VG1_P49b as decimal(15, 1)) as "П49б<br>°С [K4_VG1_P49b]",
	CAST(K4_VG1_P50b as decimal(15, 1)) as "П50б<br>°С [K4_VG1_P50b]",
	CAST(K4_VG1_P51b as decimal(15, 1)) as "П51б<br>°С [K4_VG1_P51b]",
	CAST(K4_VG1_P52b as decimal(15, 1)) as "П52б<br>°С [K4_VG1_P52b]",
	CAST(K4_VG1_P53b as decimal(15, 1)) as "П53б<br>°С [K4_VG1_P53b]",
	CAST(K4_VG1_P54b as decimal(15, 1)) as "П54б<br>°С [K4_VG1_P54b]",
	CAST(K4_VG1_P55b as decimal(15, 1)) as "П55б<br>°С [K4_VG1_P55b]",
	CAST(K4_VG1_P56b as decimal(15, 1)) as "П56б<br>°С [K4_VG1_P56b]",
	CAST(K4_VG1_P57b as decimal(15, 1)) as "П57б<br>°С [K4_VG1_P57b]",
	CAST(K4_VG1_P58b as decimal(15, 1)) as "П58б<br>°С [K4_VG1_P58b]",
	CAST(K4_VG1_P59b as decimal(15, 1)) as "П59б<br>°С [K4_VG1_P59b]",
	CAST(K4_VG1_P60b as decimal(15, 1)) as "П60б<br>°С [K4_VG1_P60b]",
	CAST(K4_VG1_P61b as decimal(15, 1)) as "П61б<br>°С [K4_VG1_P61b]",
	CAST(K4_VG1_P62b as decimal(15, 1)) as "П62б<br>°С [K4_VG1_P62b]",
	CAST(K4_VG1_P63b as decimal(15, 1)) as "П63б<br>°С [K4_VG1_P63b]",
	CAST(K4_VG1_P64b as decimal(15, 1)) as "П64б<br>°С [K4_VG1_P64b]",
	CAST(K4_VG1_P65b as decimal(15, 1)) as "П65б<br>°С [K4_VG1_P65b]",
	CAST(K4_VG1_P66b as decimal(15, 1)) as "П66б<br>°С [K4_VG1_P66b]",
	CAST(K4_VG1_P67b as decimal(15, 1)) as "П67б<br>°С [K4_VG1_P67b]",
	CAST(K4_VG1_P68b as decimal(15, 1)) as "П68б<br>°С [K4_VG1_P68b]",
	CAST(K4_VG1_P69b as decimal(15, 1)) as "П69б<br>°С [K4_VG1_P69b]",
	CAST(K4_VG1_P70b as decimal(15, 1)) as "П70б<br>°С [K4_VG1_P70b]",
	CAST(K4_VG1_P71b as decimal(15, 1)) as "П71б<br>°С [K4_VG1_P71b]",
	CAST(K4_VG1_P72b as decimal(15, 1)) as "П72б<br>°С [K4_VG1_P72b]",
	CAST(K4_VG1_P73b as decimal(15, 1)) as "П73б<br>°С [K4_VG1_P73b]",
	CAST(K4_VG1_P74b as decimal(15, 1)) as "П74б<br>°С [K4_VG1_P74b]",
	CAST(K4_VG1_P75b as decimal(15, 1)) as "П75б<br>°С [K4_VG1_P75b]",
	CAST(K4_VG1_P76b as decimal(15, 1)) as "П76б<br>°С [K4_VG1_P76b]",
	CAST(K4_VG1_P77b as decimal(15, 1)) as "П77б<br>°С [K4_VG1_P77b]",
	CAST(K4_VG1_P78b as decimal(15, 1)) as "П78б<br>°С [K4_VG1_P78b]",
	CAST(K4_VG1_P79b as decimal(15, 1)) as "П79б<br>°С [K4_VG1_P79b]",
	CAST(K4_VG1_P80b as decimal(15, 1)) as "П80б<br>°С [K4_VG1_P80b]",
	CAST(K4_VG1_P81b as decimal(15, 1)) as "П81б<br>°С [K4_VG1_P81b]",
	CAST(K4_VG1_P82b as decimal(15, 1)) as "П82б<br>°С [K4_VG1_P82b]",
	CAST(K4_VG1_P83b as decimal(15, 1)) as "П83б<br>°С [K4_VG1_P83b]",
	CAST(K4_VG1_P84b as decimal(15, 1)) as "П84б<br>°С [K4_VG1_P84b]",
	CAST(K4_VG1_P85b as decimal(15, 1)) as "П85б<br>°С [K4_VG1_P85b]",
	CAST(K4_VG1_P86b as decimal(15, 1)) as "П86б<br>°С [K4_VG1_P86b]",
	CAST(K4_VG1_P87b as decimal(15, 1)) as "П87б<br>°С [K4_VG1_P87b]",
	CAST(K4_VG1_P88b as decimal(15, 1)) as "П88б<br>°С [K4_VG1_P88b]",
	CAST(K4_VG1_P89b as decimal(15, 1)) as "П89б<br>°С [K4_VG1_P89b]",
	CAST(K4_VG1_P90b as decimal(15, 1)) as "П90б<br>°С [K4_VG1_P90b]",
	CAST(K4_VG1_P91b as decimal(15, 1)) as "П91б<br>°С [K4_VG1_P91b]",
	CAST(K4_VG1_P92b as decimal(15, 1)) as "П92б<br>°С [K4_VG1_P92b]",
	CAST(K4_VG1_P93b as decimal(15, 1)) as "П93б<br>°С [K4_VG1_P93b]",
	CAST(K4_VG1_P94b as decimal(15, 1)) as "П94б<br>°С [K4_VG1_P94b]",
	CAST(K4_VG1_P95b as decimal(15, 1)) as "П95б<br>°С [K4_VG1_P95b]"
FROM
	OpenQuery(INSQL,
	"SELECT DateTime,
	K4_VG1_P49b,
	K4_VG1_P50b,
	K4_VG1_P51b,
	K4_VG1_P52b,
	K4_VG1_P53b,
	K4_VG1_P54b,
	K4_VG1_P55b,
	K4_VG1_P56b,
	K4_VG1_P57b,
	K4_VG1_P58b,
	K4_VG1_P59b,
	K4_VG1_P60b,
	K4_VG1_P61b,
	K4_VG1_P62b,
	K4_VG1_P63b,
	K4_VG1_P64b,
	K4_VG1_P65b,
	K4_VG1_P66b,
	K4_VG1_P67b,
	K4_VG1_P68b,
	K4_VG1_P69b,
	K4_VG1_P70b,
	K4_VG1_P71b,
	K4_VG1_P72b,
	K4_VG1_P73b,
	K4_VG1_P74b,
	K4_VG1_P75b,
	K4_VG1_P76b,
	K4_VG1_P77b,
	K4_VG1_P78b,
	K4_VG1_P79b,
	K4_VG1_P80b,
	K4_VG1_P81b,
	K4_VG1_P82b,
	K4_VG1_P83b,
	K4_VG1_P84b,
	K4_VG1_P85b,
	K4_VG1_P86b,
	K4_VG1_P87b,
	K4_VG1_P88b,
	K4_VG1_P89b,
	K4_VG1_P90b,
	K4_VG1_P91b,
	K4_VG1_P92b,
	K4_VG1_P93b,
	K4_VG1_P94b,
	K4_VG1_P95b
	FROM Runtime.dbo.AnalogWideHistory 
	WHERE wwVersion = 'Latest'
	AND wwRetrievalMode = 'Cyclic'
	AND wwResolution = @resolution
	AND DateTime >= @start
	AND DateTime <= @finish")


{агрегированные за час}
/*ReportName="Отчёт КА-4 VG1. Экран 2" (агрегированные за час)*/
/*Mode=часовые-2*/
/*DownQuery="срезы на конец суток"*/
/*UpQuery="агрегированные за сутки"*/
SET QUOTED_IDENTIFIER OFF
SELECT
	DateTime as "Дата",
	null,
	CAST(AVG(K4_VG1_P49b) as decimal(15, 1)) as "П49б<br>°С [K4_VG1_P49b]",
	CAST(AVG(K4_VG1_P50b) as decimal(15, 1)) as "П50б<br>°С [K4_VG1_P50b]",
	CAST(AVG(K4_VG1_P51b) as decimal(15, 1)) as "П51б<br>°С [K4_VG1_P51b]",
	CAST(AVG(K4_VG1_P52b) as decimal(15, 1)) as "П52б<br>°С [K4_VG1_P52b]",
	CAST(AVG(K4_VG1_P53b) as decimal(15, 1)) as "П53б<br>°С [K4_VG1_P53b]",
	CAST(AVG(K4_VG1_P54b) as decimal(15, 1)) as "П54б<br>°С [K4_VG1_P54b]",
	CAST(AVG(K4_VG1_P55b) as decimal(15, 1)) as "П55б<br>°С [K4_VG1_P55b]",
	CAST(AVG(K4_VG1_P56b) as decimal(15, 1)) as "П56б<br>°С [K4_VG1_P56b]",
	CAST(AVG(K4_VG1_P57b) as decimal(15, 1)) as "П57б<br>°С [K4_VG1_P57b]",
	CAST(AVG(K4_VG1_P58b) as decimal(15, 1)) as "П58б<br>°С [K4_VG1_P58b]",
	CAST(AVG(K4_VG1_P59b) as decimal(15, 1)) as "П59б<br>°С [K4_VG1_P59b]",
	CAST(AVG(K4_VG1_P60b) as decimal(15, 1)) as "П60б<br>°С [K4_VG1_P60b]",
	CAST(AVG(K4_VG1_P61b) as decimal(15, 1)) as "П61б<br>°С [K4_VG1_P61b]",
	CAST(AVG(K4_VG1_P62b) as decimal(15, 1)) as "П62б<br>°С [K4_VG1_P62b]",
	CAST(AVG(K4_VG1_P63b) as decimal(15, 1)) as "П63б<br>°С [K4_VG1_P63b]",
	CAST(AVG(K4_VG1_P64b) as decimal(15, 1)) as "П64б<br>°С [K4_VG1_P64b]",
	CAST(AVG(K4_VG1_P65b) as decimal(15, 1)) as "П65б<br>°С [K4_VG1_P65b]",
	CAST(AVG(K4_VG1_P66b) as decimal(15, 1)) as "П66б<br>°С [K4_VG1_P66b]",
	CAST(AVG(K4_VG1_P67b) as decimal(15, 1)) as "П67б<br>°С [K4_VG1_P67b]",
	CAST(AVG(K4_VG1_P68b) as decimal(15, 1)) as "П68б<br>°С [K4_VG1_P68b]",
	CAST(AVG(K4_VG1_P69b) as decimal(15, 1)) as "П69б<br>°С [K4_VG1_P69b]",
	CAST(AVG(K4_VG1_P70b) as decimal(15, 1)) as "П70б<br>°С [K4_VG1_P70b]",
	CAST(AVG(K4_VG1_P71b) as decimal(15, 1)) as "П71б<br>°С [K4_VG1_P71b]",
	CAST(AVG(K4_VG1_P72b) as decimal(15, 1)) as "П72б<br>°С [K4_VG1_P72b]",
	CAST(AVG(K4_VG1_P73b) as decimal(15, 1)) as "П73б<br>°С [K4_VG1_P73b]",
	CAST(AVG(K4_VG1_P74b) as decimal(15, 1)) as "П74б<br>°С [K4_VG1_P74b]",
	CAST(AVG(K4_VG1_P75b) as decimal(15, 1)) as "П75б<br>°С [K4_VG1_P75b]",
	CAST(AVG(K4_VG1_P76b) as decimal(15, 1)) as "П76б<br>°С [K4_VG1_P76b]",
	CAST(AVG(K4_VG1_P77b) as decimal(15, 1)) as "П77б<br>°С [K4_VG1_P77b]",
	CAST(AVG(K4_VG1_P78b) as decimal(15, 1)) as "П78б<br>°С [K4_VG1_P78b]",
	CAST(AVG(K4_VG1_P79b) as decimal(15, 1)) as "П79б<br>°С [K4_VG1_P79b]",
	CAST(AVG(K4_VG1_P80b) as decimal(15, 1)) as "П80б<br>°С [K4_VG1_P80b]",
	CAST(AVG(K4_VG1_P81b) as decimal(15, 1)) as "П81б<br>°С [K4_VG1_P81b]",
	CAST(AVG(K4_VG1_P82b) as decimal(15, 1)) as "П82б<br>°С [K4_VG1_P82b]",
	CAST(AVG(K4_VG1_P83b) as decimal(15, 1)) as "П83б<br>°С [K4_VG1_P83b]",
	CAST(AVG(K4_VG1_P84b) as decimal(15, 1)) as "П84б<br>°С [K4_VG1_P84b]",
	CAST(AVG(K4_VG1_P85b) as decimal(15, 1)) as "П85б<br>°С [K4_VG1_P85b]",
	CAST(AVG(K4_VG1_P86b) as decimal(15, 1)) as "П86б<br>°С [K4_VG1_P86b]",
	CAST(AVG(K4_VG1_P87b) as decimal(15, 1)) as "П87б<br>°С [K4_VG1_P87b]",
	CAST(AVG(K4_VG1_P88b) as decimal(15, 1)) as "П88б<br>°С [K4_VG1_P88b]",
	CAST(AVG(K4_VG1_P89b) as decimal(15, 1)) as "П89б<br>°С [K4_VG1_P89b]",
	CAST(AVG(K4_VG1_P90b) as decimal(15, 1)) as "П90б<br>°С [K4_VG1_P90b]",
	CAST(AVG(K4_VG1_P91b) as decimal(15, 1)) as "П91б<br>°С [K4_VG1_P91b]",
	CAST(AVG(K4_VG1_P92b) as decimal(15, 1)) as "П92б<br>°С [K4_VG1_P92b]",
	CAST(AVG(K4_VG1_P93b) as decimal(15, 1)) as "П93б<br>°С [K4_VG1_P93b]",
	CAST(AVG(K4_VG1_P94b) as decimal(15, 1)) as "П94б<br>°С [K4_VG1_P94b]",
	CAST(AVG(K4_VG1_P95b) as decimal(15, 1)) as "П95б<br>°С [K4_VG1_P95b]"
FROM
	OpenQuery(INSQL,
	"SELECT DateTime, 
	K4_VG1_P49b,
	K4_VG1_P50b,
	K4_VG1_P51b,
	K4_VG1_P52b,
	K4_VG1_P53b,
	K4_VG1_P54b,
	K4_VG1_P55b,
	K4_VG1_P56b,
	K4_VG1_P57b,
	K4_VG1_P58b,
	K4_VG1_P59b,
	K4_VG1_P60b,
	K4_VG1_P61b,
	K4_VG1_P62b,
	K4_VG1_P63b,
	K4_VG1_P64b,
	K4_VG1_P65b,
	K4_VG1_P66b,
	K4_VG1_P67b,
	K4_VG1_P68b,
	K4_VG1_P69b,
	K4_VG1_P70b,
	K4_VG1_P71b,
	K4_VG1_P72b,
	K4_VG1_P73b,
	K4_VG1_P74b,
	K4_VG1_P75b,
	K4_VG1_P76b,
	K4_VG1_P77b,
	K4_VG1_P78b,
	K4_VG1_P79b,
	K4_VG1_P80b,
	K4_VG1_P81b,
	K4_VG1_P82b,
	K4_VG1_P83b,
	K4_VG1_P84b,
	K4_VG1_P85b,
	K4_VG1_P86b,
	K4_VG1_P87b,
	K4_VG1_P88b,
	K4_VG1_P89b,
	K4_VG1_P90b,
	K4_VG1_P91b,
	K4_VG1_P92b,
	K4_VG1_P93b,
	K4_VG1_P94b,
	K4_VG1_P95b
	FROM Runtime.dbo.AnalogWideHistory
	WHERE wwVersion = 'Latest'
	AND wwRetrievalMode = 'Cyclic'
	AND wwResolution = @resolution
	AND DateTime >= @start
	AND DateTime <= @finish")
GROUP BY
	DateTime
ORDER BY
	DateTime

{агрегированные за сутки}
/*ReportName="Отчёт КА-4 VG1. Экран 2" (агрегированные за сутки)*/
/*Mode=суточные-2*/
/*DownQuery="агрегированные за час"*/

SET QUOTED_IDENTIFIER OFF
SELECT
	DateAdd(day, -1, DateTime) as "Дата",
	null,
	CAST(AVG(K4_VG1_P49b) as decimal(15, 1)) as "П49б<br>°С [K4_VG1_P49b]",
	CAST(AVG(K4_VG1_P50b) as decimal(15, 1)) as "П50б<br>°С [K4_VG1_P50b]",
	CAST(AVG(K4_VG1_P51b) as decimal(15, 1)) as "П51б<br>°С [K4_VG1_P51b]",
	CAST(AVG(K4_VG1_P52b) as decimal(15, 1)) as "П52б<br>°С [K4_VG1_P52b]",
	CAST(AVG(K4_VG1_P53b) as decimal(15, 1)) as "П53б<br>°С [K4_VG1_P53b]",
	CAST(AVG(K4_VG1_P54b) as decimal(15, 1)) as "П54б<br>°С [K4_VG1_P54b]",
	CAST(AVG(K4_VG1_P55b) as decimal(15, 1)) as "П55б<br>°С [K4_VG1_P55b]",
	CAST(AVG(K4_VG1_P56b) as decimal(15, 1)) as "П56б<br>°С [K4_VG1_P56b]",
	CAST(AVG(K4_VG1_P57b) as decimal(15, 1)) as "П57б<br>°С [K4_VG1_P57b]",
	CAST(AVG(K4_VG1_P58b) as decimal(15, 1)) as "П58б<br>°С [K4_VG1_P58b]",
	CAST(AVG(K4_VG1_P59b) as decimal(15, 1)) as "П59б<br>°С [K4_VG1_P59b]",
	CAST(AVG(K4_VG1_P60b) as decimal(15, 1)) as "П60б<br>°С [K4_VG1_P60b]",
	CAST(AVG(K4_VG1_P61b) as decimal(15, 1)) as "П61б<br>°С [K4_VG1_P61b]",
	CAST(AVG(K4_VG1_P62b) as decimal(15, 1)) as "П62б<br>°С [K4_VG1_P62b]",
	CAST(AVG(K4_VG1_P63b) as decimal(15, 1)) as "П63б<br>°С [K4_VG1_P63b]",
	CAST(AVG(K4_VG1_P64b) as decimal(15, 1)) as "П64б<br>°С [K4_VG1_P64b]",
	CAST(AVG(K4_VG1_P65b) as decimal(15, 1)) as "П65б<br>°С [K4_VG1_P65b]",
	CAST(AVG(K4_VG1_P66b) as decimal(15, 1)) as "П66б<br>°С [K4_VG1_P66b]",
	CAST(AVG(K4_VG1_P67b) as decimal(15, 1)) as "П67б<br>°С [K4_VG1_P67b]",
	CAST(AVG(K4_VG1_P68b) as decimal(15, 1)) as "П68б<br>°С [K4_VG1_P68b]",
	CAST(AVG(K4_VG1_P69b) as decimal(15, 1)) as "П69б<br>°С [K4_VG1_P69b]",
	CAST(AVG(K4_VG1_P70b) as decimal(15, 1)) as "П70б<br>°С [K4_VG1_P70b]",
	CAST(AVG(K4_VG1_P71b) as decimal(15, 1)) as "П71б<br>°С [K4_VG1_P71b]",
	CAST(AVG(K4_VG1_P72b) as decimal(15, 1)) as "П72б<br>°С [K4_VG1_P72b]",
	CAST(AVG(K4_VG1_P73b) as decimal(15, 1)) as "П73б<br>°С [K4_VG1_P73b]",
	CAST(AVG(K4_VG1_P74b) as decimal(15, 1)) as "П74б<br>°С [K4_VG1_P74b]",
	CAST(AVG(K4_VG1_P75b) as decimal(15, 1)) as "П75б<br>°С [K4_VG1_P75b]",
	CAST(AVG(K4_VG1_P76b) as decimal(15, 1)) as "П76б<br>°С [K4_VG1_P76b]",
	CAST(AVG(K4_VG1_P77b) as decimal(15, 1)) as "П77б<br>°С [K4_VG1_P77b]",
	CAST(AVG(K4_VG1_P78b) as decimal(15, 1)) as "П78б<br>°С [K4_VG1_P78b]",
	CAST(AVG(K4_VG1_P79b) as decimal(15, 1)) as "П79б<br>°С [K4_VG1_P79b]",
	CAST(AVG(K4_VG1_P80b) as decimal(15, 1)) as "П80б<br>°С [K4_VG1_P80b]",
	CAST(AVG(K4_VG1_P81b) as decimal(15, 1)) as "П81б<br>°С [K4_VG1_P81b]",
	CAST(AVG(K4_VG1_P82b) as decimal(15, 1)) as "П82б<br>°С [K4_VG1_P82b]",
	CAST(AVG(K4_VG1_P83b) as decimal(15, 1)) as "П83б<br>°С [K4_VG1_P83b]",
	CAST(AVG(K4_VG1_P84b) as decimal(15, 1)) as "П84б<br>°С [K4_VG1_P84b]",
	CAST(AVG(K4_VG1_P85b) as decimal(15, 1)) as "П85б<br>°С [K4_VG1_P85b]",
	CAST(AVG(K4_VG1_P86b) as decimal(15, 1)) as "П86б<br>°С [K4_VG1_P86b]",
	CAST(AVG(K4_VG1_P87b) as decimal(15, 1)) as "П87б<br>°С [K4_VG1_P87b]",
	CAST(AVG(K4_VG1_P88b) as decimal(15, 1)) as "П88б<br>°С [K4_VG1_P88b]",
	CAST(AVG(K4_VG1_P89b) as decimal(15, 1)) as "П89б<br>°С [K4_VG1_P89b]",
	CAST(AVG(K4_VG1_P90b) as decimal(15, 1)) as "П90б<br>°С [K4_VG1_P90b]",
	CAST(AVG(K4_VG1_P91b) as decimal(15, 1)) as "П91б<br>°С [K4_VG1_P91b]",
	CAST(AVG(K4_VG1_P92b) as decimal(15, 1)) as "П92б<br>°С [K4_VG1_P92b]",
	CAST(AVG(K4_VG1_P93b) as decimal(15, 1)) as "П93б<br>°С [K4_VG1_P93b]",
	CAST(AVG(K4_VG1_P94b) as decimal(15, 1)) as "П94б<br>°С [K4_VG1_P94b]",
	CAST(AVG(K4_VG1_P95b) as decimal(15, 1)) as "П95б<br>°С [K4_VG1_P95b]"
FROM
	OpenQuery(INSQL,
	"SELECT DateTime,
	K4_VG1_P49b,
	K4_VG1_P50b,
	K4_VG1_P51b,
	K4_VG1_P52b,
	K4_VG1_P53b,
	K4_VG1_P54b,
	K4_VG1_P55b,
	K4_VG1_P56b,
	K4_VG1_P57b,
	K4_VG1_P58b,
	K4_VG1_P59b,
	K4_VG1_P60b,
	K4_VG1_P61b,
	K4_VG1_P62b,
	K4_VG1_P63b,
	K4_VG1_P64b,
	K4_VG1_P65b,
	K4_VG1_P66b,
	K4_VG1_P67b,
	K4_VG1_P68b,
	K4_VG1_P69b,
	K4_VG1_P70b,
	K4_VG1_P71b,
	K4_VG1_P72b,
	K4_VG1_P73b,
	K4_VG1_P74b,
	K4_VG1_P75b,
	K4_VG1_P76b,
	K4_VG1_P77b,
	K4_VG1_P78b,
	K4_VG1_P79b,
	K4_VG1_P80b,
	K4_VG1_P81b,
	K4_VG1_P82b,
	K4_VG1_P83b,
	K4_VG1_P84b,
	K4_VG1_P85b,
	K4_VG1_P86b,
	K4_VG1_P87b,
	K4_VG1_P88b,
	K4_VG1_P89b,
	K4_VG1_P90b,
	K4_VG1_P91b,
	K4_VG1_P92b,
	K4_VG1_P93b,
	K4_VG1_P94b,
	K4_VG1_P95b
	FROM Runtime.dbo.AnalogWideHistory 
	WHERE wwVersion = 'Latest'
	AND wwRetrievalMode = 'Cyclic'
	AND wwResolution = @resolution
	AND DateTime >= @start
	AND DateTime <= @finish")
GROUP BY
	DateTime
ORDER BY
	DateTime
